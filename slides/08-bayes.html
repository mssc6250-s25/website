<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">
<meta name="author" content="Dr.&nbsp;Cheng-Han Yu   Department of Mathematical and Statistical Sciences   Marquette University">
<title>MSSC 6250 - Spring 2025 - Bayesian Inference and Linear Regression r fontawesome::fa("scale-unbalanced")</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
<link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
<link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
<style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #24292e;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #24292e; } /* Normal */
    code span.al { color: #ff5555; font-weight: bold; } /* Alert */
    code span.an { color: #6a737d; } /* Annotation */
    code span.at { color: #d73a49; } /* Attribute */
    code span.bn { color: #005cc5; } /* BaseN */
    code span.bu { color: #d73a49; } /* BuiltIn */
    code span.cf { color: #d73a49; } /* ControlFlow */
    code span.ch { color: #032f62; } /* Char */
    code span.cn { color: #005cc5; } /* Constant */
    code span.co { color: #6a737d; } /* Comment */
    code span.cv { color: #6a737d; } /* CommentVar */
    code span.do { color: #6a737d; } /* Documentation */
    code span.dt { color: #d73a49; } /* DataType */
    code span.dv { color: #005cc5; } /* DecVal */
    code span.er { color: #ff5555; text-decoration: underline; } /* Error */
    code span.ex { color: #d73a49; font-weight: bold; } /* Extension */
    code span.fl { color: #005cc5; } /* Float */
    code span.fu { color: #6f42c1; } /* Function */
    code span.im { color: #032f62; } /* Import */
    code span.in { color: #6a737d; } /* Information */
    code span.kw { color: #d73a49; } /* Keyword */
    code span.op { color: #24292e; } /* Operator */
    code span.ot { color: #6f42c1; } /* Other */
    code span.pp { color: #d73a49; } /* Preprocessor */
    code span.re { color: #6a737d; } /* RegionMarker */
    code span.sc { color: #005cc5; } /* SpecialChar */
    code span.ss { color: #032f62; } /* SpecialString */
    code span.st { color: #032f62; } /* String */
    code span.va { color: #e36209; } /* Variable */
    code span.vs { color: #032f62; } /* VerbatimString */
    code span.wa { color: #ff5555; } /* Warning */
  </style>
<link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css">
<link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
<link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
<link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
<link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
<style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
<style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
<meta property="og:title" content="MSSC 6250 - Spring 2025 - Bayesian Inference and Linear Regression r fontawesome::fa(&quot;scale-unbalanced&quot;)">
<meta property="og:description" content="MSSC 6250 Statistical Machine Learning">
<meta property="og:site_name" content="MSSC 6250 - Spring 2025">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-color="#447099" class="quarto-title-block center"><h1 class="title">Bayesian Inference and Linear Regression <svg aria-hidden="true" role="img" viewbox="0 0 640 512" style="height:1em;width:1.25em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M522.1 62.4c16.8-5.6 25.8-23.7 20.2-40.5S518.6-3.9 501.9 1.6l-113 37.7C375 15.8 349.3 0 320 0c-44.2 0-80 35.8-80 80c0 3 .2 5.9 .5 8.8L117.9 129.6c-16.8 5.6-25.8 23.7-20.2 40.5s23.7 25.8 40.5 20.2l135.5-45.2c4.5 3.2 9.3 5.9 14.4 8.2V480c0 17.7 14.3 32 32 32H512c17.7 0 32-14.3 32-32s-14.3-32-32-32H352V153.3c21-9.2 37.2-27 44.2-49l125.9-42zM439.6 288L512 163.8 584.4 288H439.6zM512 384c62.9 0 115.2-34 126-78.9c2.6-11-1-22.3-6.7-32.1L536.1 109.8c-5-8.6-14.2-13.8-24.1-13.8s-19.1 5.3-24.1 13.8L392.7 273.1c-5.7 9.8-9.3 21.1-6.7 32.1C396.8 350 449.1 384 512 384zM129.2 291.8L201.6 416H56.7l72.4-124.2zM3.2 433.1C14 478 66.3 512 129.2 512s115.2-34 126-78.9c2.6-11-1-22.3-6.7-32.1L153.2 237.8c-5-8.6-14.2-13.8-24.1-13.8s-19.1 5.3-24.1 13.8L9.9 401.1c-5.7 9.8-9.3 21.1-6.7 32.1z"></path></svg>
</h1>
  <p class="subtitle">MSSC 6250 Statistical Machine Learning</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Dr.&nbsp;Cheng-Han Yu <br> Department of Mathematical and Statistical Sciences <br> Marquette University 
</div>
</div>
</div>

</section><section><section id="bayesian-inference" class="title-slide slide level1 center"><h1>Bayesian Inference*</h1>

</section><section id="thinking-like-a-bayesian" class="slide level2"><h2>Thinking like a Bayesian</h2>
<ol type="1">
<li>
<p><span class="green">When flipping a fair coin, we say that “the probability of flipping Heads is 0.5.” How do you interpret this probability?</span></p>
<ol type="a">
<li>If I flip this coin over and over, roughly 50% will be Heads.</li>
<li>Heads and Tails are equally plausible.</li>
<li>Both a. and b. make sense.</li>
</ol>
</li>
</ol>
<div class="fragment">
<ol start="2" type="1">
<li>
<p><span class="green">An election is coming up and a pollster claims that candidate Yu has a 0.9 probability of winning. How do you interpret this probability?</span></p>
<ol type="a">
<li>If we observe the election over and over, candidate Yu will win roughly 90% of the time.</li>
<li>Candidate Yu is much more likely to win than to lose.</li>
<li>The pollster’s calculation is wrong. Candidate Yu will either win or lose, thus their probability of winning can only be 0 or 1.</li>
</ol>
</li>
</ol>
</div>
<div class="fragment">
<ul>
<li>
<strong>1.</strong> a = 1 pt, b = 3 pts, c = 2 pts</li>
<li>
<strong>2.</strong> a = 1 pt, b = 3 pts, c = 1 pt</li>
</ul>
</div>
</section><section id="thinking-like-a-bayesian-1" class="slide level2"><h2>Thinking like a Bayesian</h2>
<ol start="3" type="1">
<li>
<p><span class="green">Two claims.</span></p>
<p><span class="green">(1) Ben claims he can predict the coin flip outcome. To test his claim, you flip a fair coin 8 times and he correctly predicts all.</span></p>
<p><span class="green">(2) Emma claims she can distinguish natural and artificial sweeteners. To test her claim, you give her 8 samples and she correctly identifies each.</span></p>
<p><span class="green">In light of these experiments, what do you conclude?</span></p>
<ol type="a">
<li>You’re more confident in Emma’s claim than Ben’s claim.</li>
<li>The evidence supporting Ben’s claim is just as strong as the evidence supporting Emma’s claim.</li>
</ol>
</li>
</ol>
<div class="fragment">
<ol start="4" type="1">
<li>
<p><span class="green">Suppose that during a doctor’s visit, you tested positive for COVID. If you only get to ask the doctor one question, which would it be?</span></p>
<ol type="a">
<li>What’s the chance that I actually have COVID?</li>
<li>If in fact I don’t have COVID, what’s the chance that I would’ve gotten this positive test result?</li>
</ol>
</li>
</ol>
</div>
<div class="fragment">
<ul>
<li>
<strong>3.</strong> a = 3 pts, b = 1 pt</li>
<li>
<strong>4.</strong> a = 3 pts, b = 1 pt</li>
</ul>
<aside class="notes"><p>Totals from 4–5 indicate that your current thinking is fairly frequentist, whereas totals from 9–12 indicate alignment with the Bayesian philosophy. In between these extremes, totals from 6–8 indicate that you see strengths in both philosophies.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section><section id="frequentist-or-bayesian" class="slide level2"><h2>Frequentist or Bayesian?</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Totals <strong>4-5</strong>: your thinking is <strong>frequentist</strong>
</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="https://upload.wikimedia.org/wikipedia/commons/a/aa/Youngronaldfisher2.JPG" class="quarto-figure quarto-figure-center" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li>Totals <strong>9-12</strong>: your thinking is <strong>Bayesian</strong>
</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="https://upload.wikimedia.org/wikipedia/commons/d/d4/Thomas_Bayes.gif" class="quarto-figure quarto-figure-center" style="width:67.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="fragment">
<ul>
<li>Totals <strong>6-8</strong>: you see strengths in both philosophies</li>
</ul>
</div>
</section><section id="the-meaning-of-probability-relative-frequency" class="slide level2"><h2>The Meaning of Probability: <strong>Relative Frequency</strong>
</h2>
<ul>
<li>The <em>frequentist</em> interprets probability as the <span class="green"><em>long-run</em> relative frequency of a <em>repeatable</em> experiment</span>.</li>
</ul>
<div class="fragment">
<p>The probability that some outcome of a process will be obtained is defined as</p>
<blockquote>
<p>the <strong>relative frequency</strong> with which that outcome would be obtained <em>if the process were repeated <strong>a large number of times</strong> independently under <strong>similar conditions</strong>.</em></p>
</blockquote>
</div>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>      Frequency Relative Frequency
Heads         4                0.4
Tails         6                0.6
Total        10                1.0
---------------------
      Frequency Relative Frequency
Heads       512              0.512
Tails       488              0.488
Total      1000              1.000
---------------------</code></pre>
</div>
</div>
<ul>
<li>If we repeat tossing the coin 10 times, the probability of obtaining heads is 40%.</li>
<li>If 1000 times, the probability is 51.2%.</li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="./images/08-bayes/coin.png" class="quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<aside class="notes"><p>source: usplash</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section><section id="issues-of-relative-frequency" class="slide level2"><h2>Issues of <strong>Relative Frequency</strong>
</h2>
<ul>
<li>😕 How large of a number is large enough?</li>
</ul>
<div class="fragment">
<ul>
<li>😕 Meaning of “under similar conditions”</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>😕 The relative frequency is reliable under identical conditions?</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>👉 We only obtain an approximation instead of exact value.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>😂 How do you compute the probability that Chicago Cubs wins the World Series next year?</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="https://media.giphy.com/media/EKURBxKKkw0uY/giphy.gif" class="quarto-figure quarto-figure-center" style="width:40.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</section><section id="the-meaning-of-probability-relative-plausibility" class="slide level2"><h2>The Meaning of Probability: <strong>Relative Plausibility</strong>
</h2>
<ul>
<li>In the <em>Bayesian</em> philosophy, a probability measures the <span class="green"><strong>relative plausibility</strong></span> of an event.</li>
</ul>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>For the statement “<em>candidate A has a 0.9 probability of winning</em>”
<ul>
<li>A frequentist might say
<ol type="i">
<li>the conclusion is wrong</li>
<li>(weirdly) in long-run <em>hypothetical</em> repetitions of the election, candidate A would win roughly 90% of the time.</li>
</ol>
</li>
<li>A Bayesian would say based on analysis the candidate A is 9 times more likely to win than to lose.</li>
</ul>
</li>
</ul>
</div><div class="column" style="width:50%;">
<div class="xsmall">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="./images/08-bayes/winning.jpeg" style="width:100.0%"></p>
<figcaption>Source: https://twitter.com/nytgraphics/status/796195155158171648/photo/1</figcaption></figure>
</div>
</div>
</div>
</div>
</div>
</div>
<aside class="notes"><ul>
<li>For the statement “<em>the probability of flipping Heads is 0.5</em>”
<ul>
<li>A frequentist would conclude that if we flip the coin over and over, roughly 1/2 of these flips will be Heads.</li>
<li>A Bayesian would conclude that Heads and Tails are equally likely.</li>
</ul>
</li>
</ul><style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section><section id="your-degree-of-uncertainty-or-ignorance" class="slide level2"><h2>Your Degree of Uncertainty or Ignorance</h2>
<div class="xsmall">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center margin-caption">
<figure><div class="quarto-figure quarto-figure-center">
<figure><p><a href="https://www.gov.uk/government/news/defence-intelligence-communicating-probability"><img data-src="./images/08-bayes/probability_yardstick.jpg" class="quarto-figure quarto-figure-center" style="width:100.0%" alt="Source: Defence Intelligence – communicating probability"></a></p>
</figure>
</div>
<figcaption>Source: Defence Intelligence – communicating probability</figcaption></figure>
</div>
</div>
</div>
</div>
<!-- :::: {.columns} -->
<!-- ::: {.column width="50%"} -->
<ul>
<li>I’m gonna flip a coin, and ask you the probability it’ll come up heads. You say “50–50”.</li>
</ul>
<div class="fragment">
<ul>
<li>I then flip the coin, take a peek, but cover it up, and ask: what’s <strong>your</strong> probability it’s heads now?</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>The event has happened, and no randomness left - just your <strong>ignorance</strong>!</li>
</ul>
</div>
<!-- ::: -->
<!-- ::: {.column width="50%"} -->
<!-- ::: -->
<!-- :::: -->
<div class="fragment">
<p>David Spiegelhalter (2024). <a href="https://www.nature.com/articles/d41586-024-04096-5">Why probability probably doesn’t exist (but it is useful to act like it does)</a>. <strong>Nature</strong>, 636, p.&nbsp;560 - 563.</p>
<aside class="notes"><p>it handles both chance and ignorance.</p>
<p>I will argue — whether in a scientific paper, as part of weather forecasts, predicting the outcome of a sports competition or quantifying a health risk — is not an objective property of the world, but a construction based on personal or collective judgements and (often doubtful) assumptions. Furthermore, in most circumstances, it is not even estimating some underlying ‘true’ quantity. Probability, indeed, can only rarely be said to ‘exist’ at all.</p>
<p>To get a handle on probability’s slipperiness, consider how the concept is used in modern weather forecasts. Meteorologists make predictions of temperature, wind speed and quantity of rain, and often also the probability of rain — say 70% for a given time and place. The first three can be compared with their ‘true’ values; you can go out and measure them. But there is no ‘true’ probability to compare the last with the forecaster’s assessment. There is no ‘probability-ometer’. It either rains or it doesn’t.</p>
<p>There is another lesson in here. Even if there is a statistical model for what should happen, this is always based on subjective assumptions</p>
<p>My argument is that any practical use of probability involves subjective judgements. This doesn’t mean that I can put any old numbers on my thoughts — I would be proved a poor probability assessor if I claimed with 99.9% certainty that I can fly off my roof, for example. The objective world comes into play when probabilities, and their underlying assumptions, are tested against reality (see ‘How ignorant am I?’); but that doesn’t mean the probabilities themselves are objective.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section><section id="everybody-changes-their-mind" class="slide level2"><h2>Everybody Changes Their Mind</h2>
<blockquote>
<p>How can we live if we don’t change? - Beyoncé. Lyric from “Satellites.”</p>
</blockquote>
<ul>
<li><p>Using <strong>data</strong> and <strong>prior beliefs</strong> to update our knowledge (<strong>posterior</strong>), and repeating.</p></li>
<li><p>We continuously update our knowledge about the world as we accumulate lived experiences, or <em>collect data</em>.</p></li>
</ul>
<div class="xsmall">
<div class="cell fig-cap-location-bottom" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="./images/08-bayes/restaurant_diagram.png" style="width:55.0%"></p>
<figcaption>Fig 1.1 of https://www.bayesrulesbook.com/. The figures not being sourced come from this book too.</figcaption></figure>
</div>
</div>
</div>
</div>
<aside class="notes"><p>Everybody changes their mind. You likely even changed your mind in the last minute. For example, suppose there’s a new Italian restaurant in your town. It has a 5-star online rating and you love Italian food! Thus, prior to ever stepping foot in the restaurant, you anticipate that it will be quite delicious. On your first visit, you collect some edible data: your pasta dish arrives a soggy mess. Weighing the stellar online rating against your own terrible meal (which might have just been a fluke), you update your knowledge: this is a 3-star not 5-star restaurant. Willing to give the restaurant another chance, you make a second trip. On this visit, you’re pleased with your Alfredo and increase the restaurant’s rating to 4 stars. You continue to visit the restaurant, collecting edible data and updating your knowledge each time.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside></section><section id="bayesian-knowledge-building-process" class="slide level2"><h2>Bayesian Knowledge-building Process</h2>

<img data-src="./images/08-bayes/bayes_diagram.png" class="quarto-figure quarto-figure-center r-stretch" style="width:30.0%"><aside class="notes"><p>If you’re an environmental scientist, yours might be an analysis of the human role in climate change. You don’t walk into such an inquiry without context – you carry a degree of incoming or prior information based on previous research and experience. Naturally, it’s in light of this information that you interpret new data, weighing both in developing your updated or posterior information.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside></section><section id="frequentist-relys-on-limited-data-only" class="slide level2"><h2>Frequentist Relys on (Limited) Data Only</h2>
<ul>
<li>In Question 3, in a frequentist analysis, “8 out of 8” is “8 out of 8” no matter if it’s in the context of Ben’s coins or Emma’s sweeteners.
<ul>
<li>
<em>Equally confident</em> conclusions that Ben can predict coin flips and Emma can distinguish between natural and artificial sweeteners.</li>
</ul>
</li>
</ul>

<img data-src="./images/08-bayes/freq_diagram.png" class="quarto-figure quarto-figure-center r-stretch" style="width:30.0%"><div class="fragment">
<ul>
<li>But do you really believe Ben’s claim 100%? 🤔 😕</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>In fact, we judge their claim before evidence are collected, don’t we? 🤔</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>You probably think Ben overstates his ability but Emma’s claim sounds relatively reasonable, right?</li>
</ul>
</div>
</section><section id="the-bayesian-balancing" class="slide level2"><h2>The Bayesian Balancing</h2>
<ul>
<li>Frequentist throws out all prior knowledge in favor of a mere 8 data points.</li>
</ul>
<div class="fragment">
<ul>
<li>Bayesian analyses <em>balance</em> and <em>weight</em> our prior experience/knowledge/belief and new data/evidence to judge a claim or make a conclusion.</li>
</ul>
<div class="cell fig-cap-location-bottom" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="./images/08-bayes/bayes-balance-1.png" class="quarto-figure quarto-figure-center" style="width:56.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="fragment">
<div class="columns">
<div class="column" style="width:80%;">
<ul>
<li>
<span class="green"><em>We are not stubborn!</em></span> If Ben had correctly predicted the outcome of <em>1 million</em> coin flips, the strength of this data would far surpass that of our prior judgement, leading to a posterior conclusion that perhaps Ben is psychic!</li>
</ul>
</div><div class="column" style="width:20%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="./images/08-bayes/psychic.jpeg" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<aside class="notes"><p>Seeing is believing</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section><section id="asking-different-questions" class="slide level2"><h2>Asking Different Questions</h2>
<div class="columns">
<div class="column" style="width:80%;">
<p>In Question 4,</p>
<ul>
<li>Bayesians answer (a) <em>what’s the chance that I actually have COVID?</em>
</li>
<li>Frequentists answer (b) <em>if in fact I do not have COVID, what’s the chance that I would’ve gotten this positive test result?</em>
</li>
</ul>
</div><div class="column" style="width:20%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="./images/08-bayes/covid.jpeg" class="quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="fragment">
<table style="width:96%;">
<colgroup>
<col style="width: 22%">
<col style="width: 22%">
<col style="width: 31%">
<col style="width: 19%">
</colgroup>
<thead><tr class="header">
<th></th>
<th>Test Positive</th>
<th>Test Negative</th>
<th>Total</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>COVID</td>
<td>3</td>
<td>1</td>
<td>4</td>
</tr>
<tr class="even">
<td>No COVID</td>
<td>9</td>
<td>87</td>
<td>96</td>
</tr>
<tr class="odd">
<td>Total</td>
<td>12</td>
<td>88</td>
<td>100</td>
</tr>
</tbody>
</table>
<ul>
<li><p><span class="math inline">\(H_0\)</span>: Do not have COVID vs.&nbsp;<span class="math inline">\(H_1\)</span>: Have COVID</p></li>
<li><p>A frequestist assesses <em>the uncertainty of the observed data in light of an assumed hypothesis</em> <span class="math inline">\(P(Data \mid H_0) = 9/96\)</span></p></li>
<li><p>A Bayesian assesses <em>the uncertainty of the hypothesis in light of the observed data</em> <span class="math inline">\(P(H_0 \mid Data) = 9/12\)</span></p></li>
</ul>
<aside class="notes"><p>a Bayesian analysis would ask: Given my positive test result, what’s the chance that I actually have the disease? Since only 3 of the 12 people that tested positive have the disease (Table 1.1), there’s only a 25% chance that you have the disease. Thus, when we take into account the disease’s rarity and the relatively high false positive rate, it’s relatively unlikely that you actually have the disease. What a relief.</p>
<p>since disease status isn’t repeatable, the probability you have the disease is either 1 or 0 – you have it or you don’t. To the contrary, medical testing (and data collection in general) is repeatable. You can get tested for the disease over and over and over. Thus, a frequentist analysis would ask: If I don’t actually have the disease, what’s the chance that I would’ve tested positive? Since only 9 of the 96 people without the disease tested positive, there’s a roughly 10% (9/96) chance that you would’ve tested positive even if you didn’t have the disease.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section><section id="fake-news" class="slide level2"><h2>Fake News</h2>
<div class="columns">
<div class="column" style="width:80%;">
<ul>
<li>To do: Predict whether or not if an incoming article is fake.</li>
</ul>
<p><br></p>
<ul>
<li>
<span class="green"><strong>Prior info</strong>:</span> 40% of the articles are fake</li>
</ul>
</div><div class="column" style="width:20%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="./images/08-bayes/fake_news.jpeg" class="quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="fragment">
<ul>
<li>
<span class="green"><strong>Data come in</strong>:</span> Check several fake and real articles, and found <code>!</code> is more consistent with fake news (Evidence).</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code> title_has_excl fake real
          FALSE   44   88
           TRUE   16    2
          Total   60   90</code></pre>
</div>
</div>
<aside class="notes"><p>The usage of an <code>!</code> might seem odd for a real article. The exclamation point data is more consistent with fake news.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section><section id="bayesian-updating-rule" class="slide level2"><h2>Bayesian Updating Rule</h2>

<img data-src="./images/08-bayes/fake_news_diagram.png" class="quarto-figure quarto-figure-center r-stretch" style="width:60.0%"><ul>
<li><p><span class="math inline">\(F\)</span>: <em>an article is fake</em>.</p></li>
<li><p>The <strong>prior probability model</strong></p></li>
</ul>
<table style="width:98%;">
<colgroup>
<col style="width: 32%">
<col style="width: 19%">
<col style="width: 28%">
<col style="width: 17%">
</colgroup>
<thead><tr class="header">
<th>Event</th>
<th><span class="math inline">\(F\)</span></th>
<th><span class="math inline">\(F^c\)</span></th>
<th>Total</th>
</tr></thead>
<tbody><tr class="odd">
<td>Probability <span class="math inline">\(P(\cdot)\)</span>
</td>
<td>0.4</td>
<td>0.6</td>
<td>1</td>
</tr></tbody>
</table></section><section id="bayesian-model-for-events" class="slide level2"><h2>Bayesian Model for Events</h2>

<img data-src="./images/08-bayes/fake_news_diagram.png" class="quarto-figure quarto-figure-center r-stretch" style="width:100.0%"><div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code> title_has_excl fake real
          FALSE   44   88
           TRUE   16    2
          Total   60   90</code></pre>
</div>
</div>
<ul>
<li><p><span class="math inline">\(D\)</span>: <em>an article title has exclamation mark</em>.</p></li>
<li><p>Conditional probability: <span class="math inline">\(P(D \mid {\color{blue}{F}}) = 16/60 = 27\%\)</span>; <span class="math inline">\(P(D \mid {\color{blue}{F^c}}) = 2/90 = 2\%\)</span>.</p></li>
</ul>
<div class="fragment">
<ul>
<li>
<span class="green"><strong>Opposite position</strong></span>:
<ul>
<li>Know the incoming article used <code>!</code> (observed data <span class="math inline">\({\color{blue}{D}}\)</span>)</li>
<li>Don’t know whether or not the article is fake <span class="math inline">\(F\)</span> (what we want to decide).</li>
</ul>
</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Compare <span class="math inline">\(P(D \mid F)\)</span> and <span class="math inline">\(P(D \mid F^c)\)</span> to ascertain the relative <strong>likelihoods</strong> of <em>observed data</em> <span class="math inline">\({\color{blue}{D}}\)</span> under different scenarios of the <em>uncertain</em> article status.</li>
</ul>
<aside class="notes"><p>Since exclamation point usage is so much more likely among fake news than real news, this data provides some evidence that the article is fake To help distinguish this application of conditional probability calculations from that when<br>
D is uncertain and F is known, we’ll utilize the following likelihood function notation.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section><section id="likelihood-function" class="slide level2"><h2>Likelihood Function</h2>
<div class="midi">
<ul>
<li>
<strong>Likelihood function</strong> <span class="math inline">\(L(\cdot\mid {\color{blue}{D}})\)</span>:</li>
</ul>
<p><span class="math display">\[L(F \mid {\color{blue}{D}}) = P({\color{blue}{D}} \mid F) \text{ and } L(F^c \mid {\color{blue}{D}}) = P({\color{blue}{D}} \mid F^c)\]</span></p>
</div>
<div class="fragment fade-in-then-out">
<div class="midi">
<ul>
<li>When <span class="math inline">\({\color{blue}{F}}\)</span> is known, the <em>conditional probability</em> function <span class="math inline">\(P(\cdot \mid {\color{blue}{F}})\)</span> compares the probabilities of an unknown event <span class="math inline">\(D\)</span>, <span class="math inline">\(D^c\)</span>, occurring with <span class="math inline">\(F\)</span>: <span class="math display">\[P(D \mid {\color{blue}{F}}) \text{  vs. } P(D^c \mid {\color{blue}{F}})\]</span>
</li>
</ul>
</div>
</div>
<div class="fragment fade-up">
<div class="midi">
<ul>
<li>When <span class="math inline">\({\color{blue}{D}}\)</span> is known, the <em>likelihood function</em> <span class="math inline">\(L(\cdot \mid {\color{blue}{D}}) = P({\color{blue}{D}} \mid \cdot)\)</span> evaluates the <em>relative compatibility</em> of data <span class="math inline">\(D\)</span> with <span class="math inline">\(F\)</span> or <span class="math inline">\(F^c\)</span>: <span class="math display">\[L(F \mid {\color{blue}{D}}) \text{  vs. } L(F^c \mid {\color{blue}{D}})\]</span>
</li>
</ul>
</div>
</div>
<div class="fragment">
<div class="small">
<table style="width:98%;">
<colgroup>
<col style="width: 36%">
<col style="width: 18%">
<col style="width: 26%">
<col style="width: 16%">
</colgroup>
<thead><tr class="header">
<th>Event</th>
<th><span class="math inline">\(F\)</span></th>
<th><span class="math inline">\(F^c\)</span></th>
<th>Total</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Probability <span class="math inline">\(P(\cdot)\)</span>
</td>
<td>0.4</td>
<td>0.6</td>
<td>1</td>
</tr>
<tr class="even">
<td>Likelihood <span class="math inline">\(L(\cdot \mid D)\)</span>
</td>
<td>0.27</td>
<td>0.02</td>
<td>0.29</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="fragment">
<ul>
<li><span class="green"><em>The likelihood function is not a probability function!</em></span></li>
</ul>
</div>
</section><section id="bayes-rule" class="slide level2"><h2>Bayes’ Rule</h2>
<p><span class="math display">\[\begin{align*} P(F \mid D) &amp;= \frac{P(F \cap D)}{P(D)}\\ &amp;= \frac{L(F \mid D)P(F)}{P(D)}\end{align*}\]</span></p>
<div class="fragment">
<p><span class="math display">\[\text{posterior = } \frac{\text{likelihood} \cdot \text{prior }}{ \text{normalizing constant}} \]</span></p>
<ul>
<li>The normalizing constant <span class="math inline">\(P(D)\)</span> is known as <strong>marginal likelihood</strong> or <strong>evidence</strong>.</li>
</ul>
<aside class="notes"><p><span class="math display">\[\begin{align*} P(F \mid D) &amp;= \frac{P(F \cap D)}{P(D)}\\ &amp;= \frac{P(D \mid F)P(F)}{P(D)} \\ &amp;= \frac{P(D \mid F)P(F)}{P(D \mid F)P(F) + P(D \mid F^c)P(F^c)}\\ &amp;= \frac{L(F \mid D)P(F)}{L(F \mid D)P(F) + L(F^c \mid D)P(F^c)}\end{align*}\]</span></p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section><section id="posterior" class="slide level2"><h2>Posterior</h2>
<ul>
<li>Started with a prior understanding that there’s a 40% chance that the incoming article would be fake.</li>
</ul>
<div class="fragment">
<ul>
<li>Yet upon observing the use of an exclamation point in the title</li>
</ul>
<div class="center">
<blockquote>
<p><em>“The president has a funny secret!”</em></p>
</blockquote>
</div>
<p>a feature that’s more common to fake news.</p>
<ul>
<li>Our posterior understanding evolved quite a bit – the chance that the article is fake jumped to 89%.</li>
</ul>
<table style="width:98%;">
<colgroup>
<col style="width: 40%">
<col style="width: 17%">
<col style="width: 24%">
<col style="width: 15%">
</colgroup>
<thead><tr class="header">
<th>Event</th>
<th><span class="math inline">\(F\)</span></th>
<th><span class="math inline">\(F^c\)</span></th>
<th>Total</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Prior prob <span class="math inline">\(P(\cdot)\)</span>
</td>
<td>0.4</td>
<td>0.6</td>
<td>1</td>
</tr>
<tr class="even">
<td>Posterior prob <span class="math inline">\(P(\cdot \mid D)\)</span>
</td>
<td>0.89</td>
<td>0.11</td>
<td>1</td>
</tr>
</tbody>
</table>
</div>
</section><section id="bayesian-inference-for-random-variables" class="slide level2"><h2>Bayesian Inference for Random Variables</h2>
<p>For any random variables parameter <span class="math inline">\(\theta\)</span> and data <span class="math inline">\({\bf Y} = (Y_1, \dots, Y_n)\)</span>,</p>
<ul>
<li><p><span class="math inline">\(\pi(\theta)\)</span>: the prior pmf/pdf of <span class="math inline">\(\theta\)</span></p></li>
<li><p><span class="math inline">\(L(\theta \mid y_1,\dots, y_n)\)</span>: the likelihood of <span class="math inline">\(\theta\)</span> given observed data <span class="math inline">\(\mathbf{y}= \{y_i \}_{i = 1}^n\)</span>.</p></li>
<li><p>The posterior distribution of <span class="math inline">\(\theta\)</span> given <span class="math inline">\(\mathbf{y}\)</span> is</p></li>
</ul>
<p><span class="math display">\[\pi(\theta \mid \mathbf{y}) = \frac{L(\theta \mid \mathbf{y})\pi(\theta)}{p(\mathbf{y})}\]</span> where <span class="math display">\[p(\mathbf{y}) = \begin{cases} \int_{\Theta} L(\theta \mid \mathbf{y})\pi(\theta) ~ d\theta &amp; \text{if } \theta \text{ is continuous }\\
\sum_{\theta \in \Theta} L(\theta \mid \mathbf{y})\pi(\theta) &amp; \text{if } \theta \text{ is discrete }
\end{cases}\]</span></p>
</section><section id="proportionality" class="slide level2"><h2>Proportionality</h2>
<p><span class="math display">\[\pi(\theta \mid \mathbf{y}) = \frac{L(\theta \mid \mathbf{y})\pi(\theta)}{p(\mathbf{y})} \propto_{\theta} L(\theta \mid \mathbf{y})\pi(\theta)\]</span></p>
<p><span class="math display">\[\text{posterior } \propto \text{ likelihood } \cdot \text{ prior } \]</span></p>
</section><section id="motivation-example" class="slide level2"><h2>Motivation Example</h2>
<div class="columns">
<div class="column" style="width:70%;">
<ul>
<li>Michelle has decided to run for governor of Wisconsin.</li>
</ul>
<!-- - You've conducted 30 different polls throughout the election season. --><ul>
<li>According to <em>previous</em> 30 polls,
<ul>
<li>Michelle’s support is centered round 45%</li>
<li>she polled at around 35% in the dreariest days and around 55% in the best days</li>
</ul>
</li>
<li>With this prior information, we’d like to estimate/update Michelle’s support by <em>conducting a new poll</em>.</li>
</ul>
</div><div class="column" style="width:30%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="./images/08-bayes/vote.jpeg" class="quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>Key: Describe prior and data information using probabilistic models.</p>
<div class="fragment">
<ul>
<li>The parameter to be estimated is <span class="math inline">\(\theta\)</span>, the Michelle’s support, which is between 0 and 1.</li>
</ul>
</div>
</section><section id="prior-distribution" class="slide level2"><h2>Prior Distribution</h2>
<ul>
<li>A popular probability distribution for probability is <strong>beta distribution</strong>, <span class="math inline">\(\text{beta}(\alpha, \beta)\)</span>, where <span class="math inline">\(\alpha &gt; 0\)</span> and <span class="math inline">\(\beta &gt; 0\)</span> are shape parameters.</li>
</ul>
<p><span class="math display">\[\pi(\theta \mid \alpha, \beta) = \frac{\Gamma(\alpha+\beta)}{\Gamma(\alpha)\Gamma(\beta)}\theta^{\alpha - 1}(1-\theta)^{\beta-1}\]</span></p>

<img data-src="https://upload.wikimedia.org/wikipedia/commons/f/f3/Beta_distribution_pdf.svg" class="quarto-figure quarto-figure-center r-stretch" style="width:100.0%"></section><section id="prior-distribution-1" class="slide level2"><h2>Prior Distribution</h2>
<ul>
<li><p><span class="math inline">\(\theta \sim \text{beta}(\alpha, \beta)\)</span></p></li>
<li><p>In the prior model, <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> are <strong>hyperparameters</strong> to be chosen to reflect our prior information.</p></li>
</ul>
<div class="fragment">
<blockquote>
<p>Michelle’s support is centered round 45%, and she polled at around 35% in the dreariest days and around 55% in the best days.</p>
</blockquote>
<ul>
<li><p>Choose <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> so that the <em>prior mean is about 0.45</em> and <em>the range is from 0.35 to 0.55</em>.</p></li>
<li><p><span class="math inline">\(\mathrm{E}(\theta) = \frac{\alpha}{\alpha + \beta}\)</span></p></li>
<li><p><span class="math inline">\(\mathrm{Var}(\theta) = \frac{\alpha\beta}{(\alpha+\beta)^2(\alpha+\beta+1)}\)</span></p></li>
</ul>
</div>
</section><section id="prior-distribution-2" class="slide level2"><h2>Prior Distribution</h2>

<img data-src="images/08-bayes/unnamed-chunk-25-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:100.0%"></section><section id="likelihood" class="slide level2"><h2>Likelihood</h2>
<blockquote>
<p>You plan to conduct a new poll of <span class="math inline">\(n = 50\)</span> Cheeseheads and record <span class="math inline">\(Y\)</span>, the number that support Michelle.</p>
</blockquote>
<div class="question">
<p>What distribution can be used for modeling likelihood connecting the data <span class="math inline">\(y\)</span> and the parameter we are interested, <span class="math inline">\(\theta\)</span>?</p>
</div>
<div class="fragment">
<ul>
<li>If voters answer the poll <em>independently</em>, and the probability that any polled voter supports Michelle is <span class="math inline">\(\theta\)</span>, we could consider</li>
</ul>
<p><span class="math display">\[Y \mid \theta \sim \text{binomial}(n=50, \theta)\]</span></p>
</div>
<div class="fragment">
<ul>
<li>The poll result is <span class="math inline">\(y = 30\)</span>, the likelihood is</li>
</ul>
<p><span class="math display">\[L(\theta \mid y = 30) = {50 \choose 30}\theta^{30}(1-\theta)^{20}, \quad \theta \in (0, 1)\]</span></p>
</div>
</section><section id="likelihood-1" class="slide level2"><h2>Likelihood</h2>

<img data-src="images/08-bayes/unnamed-chunk-26-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:100.0%"></section><section id="bayesian-model" class="slide level2"><h2>Bayesian Model</h2>
<p><span class="math display">\[\begin{align}Y \mid \theta &amp;\sim \text{binomial}(n=50, \theta)\\ \theta &amp;\sim \text{beta}(45, 55)
\end{align}\]</span></p>
<p>Goal: Obtain the posterior distribution <span class="math inline">\(\pi(\theta \mid y)\)</span>.</p>
<div class="fragment">
<p><span class="math display">\[
\begin{align} \pi(\theta \mid y) &amp;\propto_{\theta} L(\theta \mid y)\pi(\theta) \\
&amp;= {50 \choose 30}\theta^{30}(1-\theta)^{20} \times \frac{\Gamma(100)}{\Gamma(45)\Gamma(55)}\theta^{44}(1-\theta)^{54}\\
&amp;\propto_{\theta} \theta^{74}(1-\theta)^{74}\\
&amp;= \frac{\Gamma(150)}{\Gamma(75)\Gamma(75)} \theta^{74}(1-\theta)^{74} \\
&amp;= \text{beta}(75, 75)\end{align}
\]</span></p>
<p>using the fact that <span class="math inline">\(\int_{\mathcal{X}} f(x) dx = 1\)</span> for any pdf <span class="math inline">\(f(x)\)</span>.</p>
</div>
</section><section id="posterior-distribution" class="slide level2"><h2>Posterior Distribution</h2>

<img data-src="images/08-bayes/unnamed-chunk-27-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:100.0%"></section><section id="take-home-message" class="slide level2"><h2>Take-home Message</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><span class="green"><strong>Bayesian/Probabilistic</strong></span></p>
<ul>
<li>The parameter is <em>random</em>
<ul>
<li>The parameter keeps changing.</li>
<li>Even the parameter is fixed and constant, the probability distribution associated with it reflects our <em>ignorance</em>, <em>uncertainty</em>, and <em>plausibility</em> of its value, the probability we really want!</li>
</ul>
</li>
</ul>
</div><div class="column" style="width:50%;">
<p><span class="green"><strong>Frequentist/Classical</strong></span></p>
<ul>
<li>The parameter is <em>fixed</em> and <em>constant</em>
<ul>
<li>The probability is approximated by relative frequency.</li>
<li>The uncertainty is from the <em>randomness of data</em>.</li>
</ul>
</li>
</ul>
</div>
</div>
</section></section><section><section id="bayesian-linear-regression" class="title-slide slide level1 center"><h1>Bayesian Linear Regression*</h1>

</section><section id="normal-data-model" class="slide level2"><h2>Normal Data Model</h2>
<p>In simple linear regression,</p>
<p><span class="math display">\[Y_i \mid \beta_0, \beta_1, \sigma \stackrel{ind}{\sim}  N\left(\mu_i, \sigma^2 \right) \quad \text{with} \quad \mu_i = \beta_0 + \beta_1 X_i\]</span></p>
<p>This normal data model is our likelihood <span class="math inline">\(L(\boldsymbol \theta= (\beta_0, \beta_1, \sigma) \mid \mathcal{D} = \{\mathbf{y}, \mathbf{x}\})\)</span>, as it evaluates how the data are compatible with different possible values of parameters.</p>
<div class="question">
<p>To be a Bayesian, what do we do next?</p>
</div>
<div class="fragment">
<ul>
<li>Assign priors to the unknown parameters, then do the posterior inference using Bayes’ rule!</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Big question is how?</li>
</ul>
</div>
</section><section id="prior-models" class="slide level2"><h2>Prior Models</h2>
<ul>
<li>There are countless approaches to construct priors for <span class="math inline">\(\beta_0, \beta_1\)</span>, and <span class="math inline">\(\sigma\)</span>.</li>
</ul>
<div class="fragment">
<ul>
<li>For simplicity, assume <span class="math inline">\(\beta_0, \beta_1\)</span>, and <span class="math inline">\(\sigma\)</span> are <span class="green"><em>independent</em></span>, <span class="math inline">\(\pi(\boldsymbol \theta) = \pi(\beta_0, \beta_1, \sigma) = \pi(\beta_0)\pi(\beta_1)\pi(\sigma)\)</span>
</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>
<span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> can technically take any values in the real line.</li>
</ul>
<p><span class="math display">\[\begin{align} \beta_0 \sim N(m_0, s_0^2) \\
\beta_1 \sim N(m_1, s_1^2) \end{align}\]</span></p>
</div>
<div class="fragment">
<ul>
<li>
<span class="math inline">\(\sigma\)</span> must be positive.</li>
</ul>
<p><span class="math display">\[\begin{align} \sigma \sim \text{Exp}(\lambda) \end{align}\]</span> <span class="math inline">\(\pi(\sigma) = \lambda e^{-\lambda \sigma}\)</span>, <span class="math inline">\(\lambda &gt; 0\)</span> and <span class="math inline">\(\mathrm{E}(\sigma) = 1/\lambda\)</span>, and <span class="math inline">\(\mathrm{Var}(\sigma) = 1/\lambda^2\)</span></p>
<aside class="notes"><p>https://mc-stan.org/rstanarm/articles/priors.html</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section><section id="bayesian-simple-linear-regression-model" class="slide level2"><h2>Bayesian Simple Linear Regression Model</h2>
<p><span class="math display">\[\begin{align} Y_i \mid \beta_0, \beta_1, \sigma &amp;\stackrel{ind}{\sim}  N\left(\mu_i, \sigma^2 \right) \quad \text{with} \quad \mu_i = \beta_0 + \beta_1 X_i \\
\beta_0 &amp;\sim N(m_0, s_0^2) \\
\beta_1 &amp;\sim N(m_1, s_1^2) \\
\sigma &amp;\sim \text{Exp}(\lambda) \end{align}\]</span></p>
</section><section id="capital-bikeshare-bayesrulesbikes-data-in-washington-d.c." class="slide level2"><h2>Capital Bikeshare <a href="https://cran.r-project.org/web/packages/bayesrules/bayesrules.pdf"><code>bayesrules::bikes</code></a> Data in <em>Washington, D.C.</em>
</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 500
Columns: 2
$ rides     &lt;int&gt; 654, 1229, 1454, 1518, 1362, 891, 1280, 1220, 1137, 1368, 13…
$ temp_feel &lt;dbl&gt; 64.7, 49.0, 51.1, 52.6, 50.8, 46.6, 45.6, 49.2, 46.4, 45.6, …</code></pre>
</div>

</div>
<img data-src="images/08-bayes/unnamed-chunk-29-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:100.0%"></section><section id="tuning-prior-models" class="slide level2"><h2>Tuning Prior Models</h2>
<ul>
<li>
<span class="green"><em>Prior understanding 1</em></span>:
<ul>
<li>On an average temperature day, say 65 or 70 degrees, there are typically around 5000 riders, though this average could be somewhere between 3000 and 7000.</li>
</ul>
</li>
</ul>
<div class="fragment">
<ul>
<li>The prior information tells us something about <span class="math inline">\(\beta_0\)</span>, but the information has been <em>centered</em>.
<ul>
<li>The <strong>centered intercept</strong>, <span class="math inline">\(\beta_{0c}\)</span>, reflects the <em>typical</em> ridership at the <em>typical</em> temperature.</li>
</ul>
</li>
</ul>
<p><span class="math inline">\(\beta_{0c} \sim N(5000, 1000^2)\)</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="images/08-bayes/unnamed-chunk-30-1.png" class="quarto-figure quarto-figure-center" style="width:40.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</section><section id="tuning-prior-models-1" class="slide level2"><h2>Tuning Prior Models</h2>
<ul>
<li>
<span class="green"><em>Prior understanding 2</em></span>:
<ul>
<li>For every one degree increase in temperature, ridership typically increases by 100 rides, though this average increase could be as low as 20 or as high as 180.</li>
</ul>
</li>
</ul>
<div class="fragment">
<p><span class="math inline">\(\beta_{1} \sim N(100, 40^2)\)</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="images/08-bayes/unnamed-chunk-31-1.png" class="quarto-figure quarto-figure-center" style="width:55.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</section><section id="tuning-prior-models-2" class="slide level2"><h2>Tuning Prior Models</h2>
<ul>
<li>
<span class="green"><em>Prior understanding 3</em></span>:
<ul>
<li>At any given temperature, daily ridership will tend to vary with a moderate standard deviation of 1250 rides.</li>
</ul>
</li>
</ul>
<div class="fragment">
<p><span class="math inline">\(\sigma \sim \text{Exp}(0.0008)\)</span> because <span class="math inline">\(\mathrm{E}(\sigma) = 1/\lambda = 1/0.0008 = 1250\)</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="images/08-bayes/unnamed-chunk-32-1.png" class="quarto-figure quarto-figure-center" style="width:55.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</section><section id="prior-model-simulation" class="slide level2"><h2>Prior Model Simulation</h2>
<ul>
<li>100 prior plausible model lines <span class="math inline">\(\mu_{Y|X} = \beta_0 + \beta_1 X\)</span>
</li>
</ul>

<img data-src="images/08-bayes/unnamed-chunk-33-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:100.0%"></section><section id="posterior-inference" class="slide level2"><h2>Posterior Inference</h2>
<ul>
<li><p>Update our prior understanding of the relationship between ridership and temperature using data information provided by likelihood.</p></li>
<li><p>The joint posterior distribution is</p></li>
</ul>
<p><span class="math display">\[\pi(\beta_0, \beta_1, \sigma \mid \mathbf{y}) = \frac{L(\beta_0, \beta_1, \sigma \mid \mathbf{y})\pi(\beta_0, \beta_1, \sigma)}{p(\mathbf{y})}\]</span> where</p>
<ul>
<li><p><span class="math inline">\(L(\beta_0, \beta_1, \sigma \mid \mathbf{y}) = p(\mathbf{y}\mid \beta_0, \beta_1, \sigma) = \prod_{i=1}^np(y_i \mid \beta_0, \beta_1, \sigma)\)</span></p></li>
<li><p><span class="math inline">\(\pi(\beta_0, \beta_1, \sigma) = \pi(\beta_0)\pi(\beta_1)\pi(\sigma)\)</span></p></li>
<li><p><span class="math inline">\(p(\mathbf{y}) = \int \int \int \left[\prod_{i=1}^np(y_i \mid \beta_0, \beta_1, \sigma)\right]\pi(\beta_0)\pi(\beta_1)\pi(\sigma) ~ d\beta_0d\beta_1d\sigma\)</span></p></li>
<li><p>There are lots of ways to generate/approximate the posterior distribution of parameters. One method is <strong>Markov chain Monte Carlo</strong> (MCMC).</p></li>
</ul></section><section id="rstanarmstan_glm" class="slide level2"><h2><a href="https://mc-stan.org/rstanarm/"><code>rstanarm::stan_glm()</code></a></h2>
<ul>
<li>
<code>rstanarm</code> uses <a href="http://mc-stan.org/rstan/">RStan</a> syntax<sup>1</sup> to do Bayesian inference for <em>applied regression models</em> (arm).</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bike_model</span> <span class="op">&lt;-</span> <span class="fu">rstanarm</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/rstanarm/reference/stan_glm.html">stan_glm</a></span><span class="op">(</span><span class="va">rides</span> <span class="op">~</span> <span class="va">temp_feel</span>, data <span class="op">=</span> <span class="va">bikes</span>,</span>
<span>                                 family <span class="op">=</span> <span class="va">gaussian</span>,</span>
<span>                                 prior_intercept <span class="op">=</span> <span class="fu">normal</span><span class="op">(</span><span class="fl">5000</span>, <span class="fl">1000</span><span class="op">)</span>,</span>
<span>                                 prior <span class="op">=</span> <span class="fu">normal</span><span class="op">(</span><span class="fl">100</span>, <span class="fl">40</span><span class="op">)</span>, </span>
<span>                                 prior_aux <span class="op">=</span> <span class="fu">exponential</span><span class="op">(</span><span class="fl">0.0008</span><span class="op">)</span>,</span>
<span>                                 chains <span class="op">=</span> <span class="fl">4</span>, iter <span class="op">=</span> <span class="fl">5000</span><span class="op">*</span><span class="fl">2</span>, seed <span class="op">=</span> <span class="fl">2025</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><p>Generate 4 Monte Carlo chains (<code>chains = 4</code>), each having 10000 iterations (<code>iter = 5000*2</code>).</p></li>
<li><p>Each iteration draw a posterior sample of the <span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span>, and <span class="math inline">\(\sigma\)</span>.</p></li>
<li><p>After tossing out the first half of Markov chain values from the <strong>warm-up</strong> or <strong>burn-in</strong> phase, <code>stan_glm()</code> simulation produces four parallel chains of length 5000 for each model parameter:</p></li>
</ul>
<p><span class="math inline">\(\{ \beta_0^{(1)}, \beta_0^{(2)}, \dots, \beta_0^{(5000)} \}\)</span>, <span class="math inline">\(\{ \beta_1^{(1)}, \beta_1^{(2)}, \dots, \beta_1^{(5000)} \}\)</span>, <span class="math inline">\(\{ \sigma^{(1)}, \sigma^{(2)}, \dots, \sigma^{(5000)} \}\)</span></p>
<aside><ol class="aside-footnotes"><li id="fn1"><p>RStan is the R interface to <a href="https://mc-stan.org/">Stan</a>.</p></li></ol></aside></section><section id="convergence-diagnostics" class="slide level2"><h2>Convergence Diagnostics</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Trace plots of parallel chains</span></span>
<span><span class="fu">bayesplot</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-traces.html">mcmc_trace</a></span><span class="op">(</span><span class="va">bike_model</span>, size <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="images/08-bayes/unnamed-chunk-35-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:100.0%"></section><section id="convergence-diagnostics-1" class="slide level2"><h2>Convergence Diagnostics</h2>
<div class="xsmall">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="https://blog.stata.com/wp-content/uploads/2016/11/animation3.gif" style="width:100.0%"></p>
<figcaption>Source: https://blog.stata.com/2016/11/15/introduction-to-bayesian-statistics-part-2-mcmc-and-the-metropolis-hastings-algorithm/</figcaption></figure>
</div>
</div>
</div>
</div>
</section><section id="convergence-diagnostics-2" class="slide level2"><h2>Convergence Diagnostics</h2>

<img data-src="./images/08-bayes/metropolis_hastings_animation.gif" class="quarto-figure quarto-figure-center r-stretch" style="width:100.0%"></section><section id="convergence-diagnostics-3" class="slide level2"><h2>Convergence Diagnostics</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Density plots of parallel chains</span></span>
<span><span class="fu">bayesplot</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-distributions.html">mcmc_dens_overlay</a></span><span class="op">(</span><span class="va">bike_model</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="images/08-bayes/unnamed-chunk-38-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:100.0%"><aside class="notes"><ul>
<li>quantifies the number of independent samples it would take to produce an equivalently accurate posterior approximation.</li>
<li>we observe that these four chains produce nearly indistinguishable posterior approximations. This provides evidence that our simulation is stable and sufficiently long – running the chains for more iterations likely wouldn’t produce drastically different or improved posterior approximations.</li>
</ul><style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside></section><section id="convergence-diagnostics-4" class="slide level2"><h2>Convergence Diagnostics</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Effective sample size ratio</span></span>
<span><span class="fu">bayesplot</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/bayesplot-extractors.html">neff_ratio</a></span><span class="op">(</span><span class="va">bike_model</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)   temp_feel       sigma 
      0.995       0.992       0.950 </code></pre>
</div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Rhat</span></span>
<span><span class="fu">bayesplot</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/bayesplot-extractors.html">rhat</a></span><span class="op">(</span><span class="va">bike_model</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)   temp_feel       sigma 
          1           1           1 </code></pre>
</div>
</div>
<ul>
<li>Both effective sample size and R-hat are close to 1, indicating that the chains are <em>stable</em>, <em>mixing quickly</em>, and behaving much like an <em>independent</em> sample.</li>
</ul>
<aside class="notes"><ul>
<li>There’s no magic rule for interpreting this ratio, and it should be utilized alongside other diagnostics such as the trace plot. That said, we might be suspicious of a Markov chain for which the effective sample size ratio is less than 0.1, i.e., the effective sample size is less than 10% of the actual sample size.</li>
<li>an R-hat ratio greater than 1.05 raises some red flags about the stability of the simulation.</li>
</ul><style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside></section><section id="convergence-issues" class="slide level2"><h2>Convergence Issues</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>
<span class="green"><em>Highly Autocorrelated Chain</em></span>: Effective size is small, not many independent samples that are representative of the true posterior distribution.
<ul>
<li>Run longer and <em>thinning</em> the chain</li>
</ul>
</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="images/08-bayes/unnamed-chunk-40-1.png" class="quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li>
<span class="green"><em>Slow Convergence</em></span>: Need wait longer to have the chain reached a stable mixing zone that are representative of the true posterior distribution.
<ul>
<li>Set a longer <em>burn-in</em> or <em>warm-up</em> period</li>
</ul>
</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="images/08-bayes/unnamed-chunk-41-1.png" class="quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section><section id="interpreting-the-posterior" class="slide level2"><h2>Interpreting the Posterior</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Posterior summary statistics</span></span>
<span><span class="fu">tidy</span><span class="op">(</span><span class="va">bike_model</span>, effects <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"fixed"</span>, <span class="st">"aux"</span><span class="op">)</span>,</span>
<span>     conf.int <span class="op">=</span> <span class="cn">TRUE</span>, conf.level <span class="op">=</span> <span class="fl">0.80</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
  term        estimate std.error conf.low conf.high
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)  -2191.     355.    -2653.    -1735. 
2 temp_feel       82.1      5.07     75.7      88.7
3 sigma         1282.      41.1    1231.     1336. 
4 mean_PPD      3487.      80.3    3385.     3590. </code></pre>
</div>
</div>
<ul>
<li>The posterior relationship is</li>
</ul>
<p><span class="math display">\[-2196 + 82.2 X\]</span></p>
<ul>
<li><p>The 80% <strong>credible interval</strong> for <span class="math inline">\(\beta_1\)</span> is <span class="math inline">\((75.7, 88.5)\)</span>.</p></li>
<li><p>Given the data, the <span class="green"><em>probability that <span class="math inline">\(\beta_1\)</span> is between 75.7 and 88.5 is 80%.</em></span>, i.e., <span class="math inline">\(P(\beta_1 \in(75.7, 88.5) \mid \mathbf{y}, \mathbf{x}) = 80\%\)</span>.</p></li>
</ul></section><section id="posterior-samples" class="slide level2"><h2>Posterior Samples</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Store the 4 chains for each parameter in 1 data frame</span></span>
<span><span class="va">bike_model_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">bike_model</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">bike_model_df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20000</code></pre>
</div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">bike_model_df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept) temp_feel sigma
1       -2318      83.0  1304
2       -2107      81.9  1261
3       -2460      85.9  1246
4       -2419      84.7  1394
5       -2067      79.5  1202
6       -1806      75.6  1224</code></pre>
</div>
</div>
<p>How to obtain <span class="math inline">\(P(\beta_1 &gt; 0 \mid \mathbf{y}, \mathbf{x})\)</span>?</p>
<div class="fragment">
<p><span class="math inline">\(P(\beta_1 &gt; 0 \mid \mathbf{y}, \mathbf{x}) \approx \frac{1}{20000}\sum_{t=1}^{20000} \mathbf{1}\left(\beta_1^{(t)} &gt; 0\right)\)</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">bike_model_df</span><span class="op">$</span><span class="va">temp_feel</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">bike_model_df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
</div>
</section><section id="posterior-regression-lines" class="slide level2"><h2>Posterior Regression Lines</h2>

<img data-src="images/08-bayes/unnamed-chunk-45-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:100.0%"></section><section id="posterior-predictive-draws" class="slide level2"><h2>Posterior Predictive Draws</h2>
<p>For each posterior draw <span class="math inline">\(\{\beta_0^{(t)}, \beta_1^{(t)}, \sigma^{(t)} \}_{t = 1}^{20000}\)</span>, we have the <strong>posterior predictive distribution</strong> <span class="math display">\[Y_i^{(t)} \sim N\left(\beta_0^{(t)} + \beta_1^{(t)}X_i, \, (\sigma^{(t)})^2\right)\]</span></p>

<img data-src="images/08-bayes/unnamed-chunk-46-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:100.0%"></section><section id="bayesian-interpretation-for-ridge-and-lasso" class="slide level2"><h2>Bayesian Interpretation for Ridge and Lasso</h2>
<ul>
<li><p>Lasso and Ridge regression can be interpreted as a Bayesian regression model.</p></li>
<li><p>The same data-level likelihood <span class="math display">\[Y_i \mid \boldsymbol \beta, \sigma \stackrel{ind}{\sim}  N\left(\mu_i, \sigma^2 \right) \quad \text{with} \quad \mu_i = \mathbf{x}_i'\boldsymbol \beta\]</span></p></li>
<li><p>We use prior distributions to <em>regularize</em> how parameters behave.</p></li>
</ul>
<div class="fragment">
<ul>
<li>The two methods can assign the same prior distributions to <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\sigma\)</span>, but they use <em>different priors on <span class="math inline">\(\{\beta_j\}_{j = 1}^p\)</span></em>.<sup>1</sup>
<ul>
<li><p><span class="green"><strong>Lasso</strong></span>: <a href="https://en.wikipedia.org/wiki/Laplace_distribution"><span class="math inline">\(\beta_j \stackrel{iid}{\sim} \text{Laplace}\left(0, \tau(\lambda)\right)\)</span></a></p></li>
<li><p><span class="green"><strong>Ridge</strong></span>: <span class="math inline">\(\beta_j \stackrel{iid}{\sim} N\left(0, \tau(\lambda)\right)\)</span></p></li>
</ul>
</li>
</ul>
</div>
<aside><ol class="aside-footnotes"><li id="fn2"><p>Remember we usually standardize coefficients before implementing Ridge and Lasso.</p></li></ol></aside></section><section id="ridge-and-lasso-priors" class="slide level2"><h2>Ridge and Lasso Priors</h2>
<div class="columns">
<div class="column">
<p><span class="green"><strong>Lasso</strong></span></p>
<div style="font-size: 0.8em;">
<p><span class="math display">\[\beta_j \stackrel{iid}{\sim} \text{Laplace}\left(0, \tau(\lambda)\right)\]</span></p>
<p>Lasso solution is the <strong>posterior mode</strong> of <span class="math inline">\(\boldsymbol \beta\)</span></p>
<p><span class="math display">\[\boldsymbol \beta^{(l)} = \mathop{\mathrm{arg\,max}}_{\boldsymbol \beta} \,\,\, \pi(\boldsymbol \beta\mid \mathbf{y}, \mathbf{x})\]</span></p>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="images/08-bayes/unnamed-chunk-47-1.png" class="quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column">
<p><span class="green"><strong>Ridge</strong></span></p>
<div style="font-size: 0.8em;">
<p><span class="math display">\[\beta_j \stackrel{iid}{\sim} N\left(0, \tau(\lambda)\right)\]</span></p>
<p>Ridge solution is the <strong>posterior mode/mean</strong> of <span class="math inline">\(\boldsymbol \beta\)</span></p>
<p><span class="math display">\[\boldsymbol \beta^{(r)} = \mathop{\mathrm{arg\,max}}_{\boldsymbol \beta} \,\, \, \pi(\boldsymbol \beta\mid \mathbf{y}, \mathbf{x})\]</span></p>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="images/08-bayes/unnamed-chunk-48-1.png" class="quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section><section id="resources" class="slide level2"><h2>Resources</h2>
<ul>
<li><p><a href="https://www.bayesrulesbook.com/">Bayes Rules! An Introduction to Applied Bayesian Modeling</a></p></li>
<li><p><a href="https://xcelab.net/rm/statistical-rethinking/">Statistical Rethinking</a></p></li>
<li><p><a href="https://uk.sagepub.com/en-gb/eur/book/student%E2%80%99s-guide-bayesian-statistics">A Student’s Guide to Bayesian Statistics</a></p></li>
<li><p><a href="http://www.stat.columbia.edu/~gelman/book/">Bayesian Data Analysis</a></p></li>
</ul>
<!-- ## Bayes Factor --><!-- ## Posterior Predictive Distribution --><!-- ## Sensitivity Analysis -->
<div class="quarto-auto-generated-content">
<p><img src="https://upload.wikimedia.org/wikipedia/commons/e/e8/Marquette_Golden_Eagles_logo.svg" class="slide-logo"></p>
<div class="footer footer-default">
<p><a href="https://mssc6250-s25.github.io/website/">mssc6250-s25.github.io/website</a></p>
</div>
</div>
</section></section>
</div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="../site_libs/revealjs/dist/reveal.js"></script><!-- reveal.js plugins --><script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script><script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script><script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script><script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script><script src="../site_libs/revealjs/plugin/multiplex/socket.io.js"></script><script src="../site_libs/revealjs/plugin/multiplex/multiplex.js"></script><script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script><script src="../site_libs/revealjs/plugin/notes/notes.js"></script><script src="../site_libs/revealjs/plugin/search/search.js"></script><script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script><script src="../site_libs/revealjs/plugin/math/math.js"></script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'multiplex': {"secret":null,"id":"f1ab4753ba9cf123","url":"https://reveal-multiplex.glitch.me/"},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1800,

        height: 1000,

        // Factor of the display size that should remain empty around the content
        margin: 5.0e-2,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          
          RevealSearch,
          RevealZoom
        ]
      });
    </script><script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script><script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp("https:\/\/mssc6250-s25\.github\.io\/website\/");
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>


</body></html>